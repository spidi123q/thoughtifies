var applicationServerPublicKey="BAQZq2fU0WXMO8algZPK3X_I0gQalpPgiZtDNQkRZt8KMixVo0QNFGebvXvpLPm7V2foc3ITykg4WVc8X-pUuCA";var isSubscribed=false;var swRegistration=null;function urlB64ToUint8Array(base64String){var padding="=".repeat((4-base64String.length%4)%4);var base64=(base64String+padding).replace(/\-/g,"+").replace(/_/g,"/");var rawData=window.atob(base64);var outputArray=new Uint8Array(rawData.length);for(var i=0;i<rawData.length;++i){outputArray[i]=rawData.charCodeAt(i)}return outputArray}if("serviceWorker"in navigator&&"PushManager"in window){navigator.serviceWorker.register(BASE_URL+"sw.js").then(function(swReg){swRegistration=swReg;initialiseUI()}).catch(function(error){})}else{pushButton.textContent="Push Not Supported"}function initialiseUI(){swRegistration.pushManager.getSubscription().then(function(subscription){isSubscribed=!(subscription===null);if(isSubscribed){}else{subscribeUser()}})}function subscribeUser(){var applicationServerKey=urlB64ToUint8Array(applicationServerPublicKey);swRegistration.pushManager.subscribe({userVisibleOnly:true,applicationServerKey:applicationServerKey}).then(function(subscription){updateSubscriptionOnServer(subscription);isSubscribed=true}).catch(function(err){})}function updateSubscriptionOnServer(subscription){if(subscription){var data=JSON.stringify(subscription);var xhttp=new XMLHttpRequest;xhttp.open("POST","subscribe/webpush",true);xhttp.setRequestHeader("Content-type","application/json");xhttp.send(data)}else{}}